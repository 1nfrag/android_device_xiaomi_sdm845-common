type hal_mlipay_default, domain;

type hal_mlipay_default_exec, exec_type, vendor_file_type, file_type;

init_daemon_domain(hal_mlipay_default)

binder_call(hal_mlipay_client, hal_mlipay_server)

allow hal_mlipay_client hal_mlipay_hwservice:hwservice_manager find;

allow hal_mlipay_default hal_mlipay_hwservice:hwservice_manager add;
allow hal_mlipay_server hidl_base_hwservice:hwservice_manager add;
allow hal_mlipay_default hidl_base_hwservice:hwservice_manager add;

allow hal_mlipay_default tee_device:chr_file rw_file_perms;
allow hal_mlipay_default ion_device:chr_file r_file_perms;

allow hal_mlipay_default init:unix_stream_socket connectto;

allow hal_mlipay_default firmware_file:dir {ioctl read getattr lock search open};
allow hal_mlipay_default firmware_file:file {ioctl read getattr lock map open};

allow hal_mlipay_default hwservicemanager:binder {call transfer};

allow hal_mlipay_default hwservicemanager_prop:file { ioctl read getattr lock map open };
allow hal_mlipay_default property_socket:sock_file write;

allow hal_mlipay_default hal_mtdservice_default:binder transfer;

allow hal_mlipay_default hal_mlipay_default_exec:file {read getattr map execute entrypoint open};
